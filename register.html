<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ê²Œì„ ê²°ê³¼ ë“±ë¡</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
</head>
<body class="bg-gray-100 text-gray-800">
  <div class="max-w-2xl mx-auto p-4">
    <h1 class="text-2xl font-bold text-center mb-6">ğŸ® ê²Œì„ ê²°ê³¼ ë“±ë¡</h1>
    <form id="gameForm" class="space-y-4 bg-white shadow p-6 rounded">
      <!-- ë‚ ì§œ ì…ë ¥ -->
      <div>
        <label class="block mb-1 font-semibold">ë‚ ì§œ</label>
        <input type="date" name="date" class="w-full border rounded p-2" required />
      </div>

      <!-- ì‹œíŠ¸ ì„ íƒ -->
      <div>
        <label class="block mb-1 font-semibold">ì‹œë‚˜ë¦¬ì˜¤ ì„ íƒ</label>
        <select name="scenario" id="scenario" class="w-full border rounded p-2" required>
          <option value="">â–¼ ì„ íƒí•´ì£¼ì„¸ìš”</option>
          <option value="íŠ¸ëŸ¬ë¸” ë¸Œë£¨ì‰">íŠ¸ëŸ¬ë¸” ë¸Œë£¨ì‰</option>
          <option value="ì„¹ì¸ ì•¤ë°”ì´ì˜¬ë ›">ì„¹ì¸ ì•¤ë°”ì´ì˜¬ë ›</option>
          <option value="ë°°ë“œë¬¸ë¼ì´ì§•">ë°°ë“œë¬¸ë¼ì´ì§•</option>
          <option value="í¬ì¼“ëª¬ìŠ¤í„°">í¬ì¼“ëª¬ìŠ¤í„°</option>
          <option value="ë°˜ë€ì˜ ê±°ì¹œë°”ë‹¤">ë°˜ë€ì˜ ê±°ì¹œë°”ë‹¤</option>
          <option value="ë¡œë§ˆ">ë¡œë§ˆ</option>
          <option value="Custom">ì»¤ìŠ¤í…€ ìŠ¤í¬ë¦½íŠ¸</option>
        </select>
      </div>

      <!-- í”Œë ˆì´ì–´ ìˆ˜ ì…ë ¥ -->
      <div>
        <label class="block mb-1 font-semibold">í”Œë ˆì´ì–´ ìˆ˜</label>
        <input type="number" id="playerCount" name="playerCount" min="1" max="20" value="5" class="w-full border rounded p-2" required />
      </div>

      <!-- ë™ì  ìºë¦­í„° ì…ë ¥ ì˜ì—­ -->
      <div id="playerInputs" class="space-y-4"></div>

      <button type="submit" class="w-full bg-blue-500 text-white font-semibold py-2 rounded hover:bg-blue-600">ì €ì¥í•˜ê¸°</button>
    </form>

    <div class="mt-4 text-center">
      <a href="index.html" class="text-blue-500 hover:underline">â† í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
    </div>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCqk52hH5uwWvC8L81l8d6kZgCN2Ynt_Rg",
      authDomain: "blood-on-the-clock-tower-613ce.firebaseapp.com",
      projectId: "blood-on-the-clock-tower-613ce",
      storageBucket: "blood-on-the-clock-tower-613ce.firebasestorage.app",
      messagingSenderId: "619177302977",
      appId: "1:619177302977:web:3b282744ff5b00469e6d40",
      measurementId: "G-W8THYT2M1J"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    document.getElementById('gameForm').addEventListener('submit', async function (e) {
      e.preventDefault();

      const date = e.target.date.value;
      const scenario = e.target.scenario.value;
      const playerCount = parseInt(e.target.playerCount.value);
      const players = [];

      for (let i = 0; i < playerCount; i++) {
        const name = e.target[`player${i}_name`]?.value;
        const character = e.target[`player${i}_character`]?.value;
        const win = e.target[`player${i}_win`]?.value;
        const team = e.target[`player${i}_team`] ? e.target[`player${i}_team`].value : null;
        const role = e.target[`player${i}_role`] ? e.target[`player${i}_role`].value : null;

        players.push({ name, character, team, role, win });
      }

      await db.collection("games").add({
        date,
        scenario,
        players,
        timestamp: new Date()
      });

      alert('ë°ì´í„°ê°€ Firebaseì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
      e.target.reset();
    });
  </script>
</body>
</html>
